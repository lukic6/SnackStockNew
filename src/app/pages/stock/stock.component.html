<div class="stock-container">
    <!-- Header with title and Add button -->
    <div class="stock-header">
        <h3 class="page-header">Stock</h3>
        <dx-button
        icon="plus"
        text="Add Item"
        stylingMode="contained"
        type="default"
        (onClick)="onAddItemClick()"
        ></dx-button>
    </div>

    <!-- DataGrid for stock items -->
    <dx-data-grid
        [dataSource]="stockItems"
        [showBorders]="true"
        height="400px"
        (onRowRemoving)="onRowRemoving($event)"
        (onRowUpdating)="onRowUpdating($event)"
    >
        <dxo-editing
            mode="popup"
            [allowUpdating]="true"
            [allowDeleting]="true"
            [confirmDelete]="false"
        >
        <dxo-popup
            [title]="'Edit Item'"
            [showTitle]="true"
            [width]="'90%'"
            [maxWidth]="420"
            [height]="'auto'"
            [dragEnabled]="false"
            [hideOnOutsideClick]="true"
            (onHiding)="onPopupClose()"
        ></dxo-popup>
        <dxo-form [colCount]="1">
            <dxi-item dataField="item" [isRequired]="true">
                <dxo-label text="Item"></dxo-label>
                <dxi-validation-rule type="required" message="Item is required"></dxi-validation-rule>
            </dxi-item>
            <dxi-item dataField="quantity" [isRequired]="true">
                <dxo-label text="Quantity"></dxo-label>
                <dxi-validation-rule type="required" message="Quantity is required"></dxi-validation-rule>
            </dxi-item>
            <dxi-item dataField="measurement" [isRequired]="true">
                <dxo-label text="Measurement"></dxo-label>
                <dxi-validation-rule type="required" message="Measurement is required"></dxi-validation-rule>
            </dxi-item>
        </dxo-form>
        </dxo-editing>
        <dxi-column caption="Item" [calculateCellValue]="item_quantity_measurement"></dxi-column>
    </dx-data-grid>

    <!-- Popup for adding/editing items -->
    <dx-popup
        [visible]="popupVisible"
        [showCloseButton]="true"
        [width]="'90%'"
        [maxWidth]="420"
        [height]="'auto'"
        [dragEnabled]="false"
        [hideOnOutsideClick]="true"
        (onHiding)="onPopupClose()"
        title="Add Item"
    >
        <dx-form [formData]="selectedItem">
            <dxi-item dataField="item" label="Item">
                <dxi-validation-rule type="required" message="Item is required"></dxi-validation-rule>
            </dxi-item>
            <dxi-item dataField="quantity" label="Quantity">
                <dxi-validation-rule type="required" message="Quantity is required"></dxi-validation-rule>
            </dxi-item>
            <dxi-item dataField="measurement" label="Measurement">
                <dxi-validation-rule type="required" message="Measurement is required"></dxi-validation-rule>
            </dxi-item>

            <!-- Save Button -->
            <dxi-item itemType="button">
                <dxo-button-options
                    text="Save"
                    type="default"
                    stylingMode="contained"
                    [onClick]="onSaveItem"
                ></dxo-button-options>
            </dxi-item>
        </dx-form>
    </dx-popup>
</div>